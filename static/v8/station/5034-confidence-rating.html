<!DOCTYPE html>
<!-- saved from url=(0052)http://localhost:3000/station/5034-confidence-rating -->
<html lang="en"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>
Irk at Collyhurst Weir - Latest river level information - GOV.UK
</title>

    <!--[if gt IE 8]><!--><link href="../assets/govuk-template.css" media="screen" rel="stylesheet"><!--<![endif]-->
    <!--[if IE 6]><link href="/public/stylesheets/govuk-template-ie6.css?0.19.1" media="screen" rel="stylesheet" /><![endif]-->
    <!--[if IE 7]><link href="/public/stylesheets/govuk-template-ie7.css?0.19.1" media="screen" rel="stylesheet" /><![endif]-->
    <!--[if IE 8]><link href="/public/stylesheets/govuk-template-ie8.css?0.19.1" media="screen" rel="stylesheet" /><![endif]-->
    <link href="../assets/govuk-template-print.css" media="print" rel="stylesheet">

    <!--[if IE 8]><link href="/public/stylesheets/fonts-ie8.css?0.19.1" media="all" rel="stylesheet" /><![endif]-->
    <!--[if gte IE 9]><!--><link href="../assets/fonts.css" media="all" rel="stylesheet"><!--<![endif]-->
    <!--[if lt IE 9]><script src="/public/javascripts/ie.js?0.19.1"></script><![endif]-->

    <link rel="shortcut icon" href="http://localhost:3000/public/images/favicon.ico?0.19.1" type="image/x-icon">
    <link rel="mask-icon" href="http://localhost:3000/public/images/gov.uk_logotype_crown.svg?0.19.1" color="#0b0c0c">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://localhost:3000/public/images/apple-touch-icon-152x152.png?0.19.1">
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://localhost:3000/public/images/apple-touch-icon-120x120.png?0.19.1">
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://localhost:3000/public/images/apple-touch-icon-76x76.png?0.19.1">
    <link rel="apple-touch-icon-precomposed" href="http://localhost:3000/public/images/apple-touch-icon-60x60.png?0.19.1">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:image" content="/public/images/opengraph-image.png?0.19.1">

    
  <!--[if gt IE 8]><!--><link href="../assets/application.css" rel="stylesheet" type="text/css"><!--<![endif]-->
<!--[if IE 6]><link href="/public/stylesheets/application-ie6.css" rel="stylesheet" type="text/css" /><![endif]-->
<!--[if IE 7]><link href="/public/stylesheets/application-ie7.css" rel="stylesheet" type="text/css" /><![endif]-->
<!--[if IE 8]><link href="/public/stylesheets/application-ie8.css" rel="stylesheet" type="text/css" /><![endif]-->

  <link href="../assets/prism.css" media="screen" rel="stylesheet">

  <link rel="stylesheet" href="../assets/ol.css" type="text/css">
  <script src="../assets/ol.js" type="text/javascript"></script>

  </head>

  <body class="js-enabled">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    

    <div id="skiplink-container">
      <div>
        <a href="http://localhost:3000/station/5034-confidence-rating#content" class="skiplink">Skip to main content</a>
      </div>
    </div>

    <div id="global-cookie-message">
      
        
  <p>GOV.UK uses cookies to make the site simpler. <a href="https://www.gov.uk/help/cookies" title="Find out more about cookies">Find out more about cookies</a></p>

      
    </div>

    
    <header role="banner" id="global-header" class="
  with-proposition
">
      <div class="header-wrapper">
        <div class="header-global">
          <div class="header-logo">
            <a href="https://www.gov.uk/" title="Go to the GOV.UK homepage" id="logo" class="content">
              <img src="../assets/gov.uk_logotype_crown_invert_trans.png" width="36" height="32" alt=""> GOV.UK
            </a>
          </div>
          
        </div>
        
  <div class="header-proposition">
  <div class="content">
    <a href="http://localhost:3000/station/5034-confidence-rating#proposition-links" class="js-header-toggle menu">Menu</a>
    <nav id="proposition-menu">
      <a href="http://localhost:3000/" id="proposition-name">Flood information service</a>
    </nav>
  </div>
</div>


      </div>
    </header>
    

    

    <div id="global-header-bar"></div>

    

<main id="content" role="main" tabindex="-1">

  <div class="phase-banner-beta phase-banner-disclaimer">
  <p>
    <strong class="phase-tag">Beta</strong>
    <span>
        Access to this private beta service is restricted. Please use it and <a href="https://docs.google.com/forms/d/e/1FAIpQLSeu2f7EOR4Jx_DF5Rd-7afHe6vZFKE2Rg0IWRFS4BtppojtRw/viewform" target="_blank">give us your feedback</a>. This will help us develop and improve the service for future users.
        <br><br>
        Alternatively, you can <a href="https://flood-warning-information.service.gov.uk/">view the live flood information service</a> at any time.
      </span>
  </p>
</div>


  <div class="grid-row">
    
    <div class="column-two-thirds">

      <h1 class="heading-xlarge">
        
<span class="heading-secondary">Latest river level information for</span>
Irk at Collyhurst Weir

      </h1>

      <p class="time-stamp">1.30pm on Tuesday 16 May 2017</p>

      
<p class="lede lede-station">
	River levels here are forecast to stay within this river's normal range during the next 36 hours.
</p>


    </div>

    <!--
    <div class="column-third">
      
      <aside class="related" role="complementary">

        <h2 class="heading-medium related-title">River levels</h2>
        
        <nav role="navigation">

          <ul>

              <li class="related-item">
                <a href="/river-levels">How might river levels affect flood risk?</a>
              </li>

              <li class="related-item">
                <a href="/river-levels">How river levels are measured?</a>
              </li>

              <li class="related-item">
                <a href="/river-levels">How forecast levels are produced?</a>
              </li>

          </ul>

        </nav>

      </aside>

    </div>
    -->

  </div>

  

<div class="grid-row">

	<div class="column-two-thirds">

		<section aria-labelledby="levels-heading" role="region">

			<h2 id="levels-heading" class="heading-medium">
				River levels at this location
			</h2>     

			<p>
				We have <strong class="bold-small">high confidence</strong> in this forecast
			</p>

			<div class="visualisation" role="presentation" aria-hidden="true">

				<!--
					If Google Charts available (Javascript, SVG or VML)
					remove hidden class and hidden attribute
				-->

				<div class="visualisation-inner">

					<figure class="graph" role="presentation" aria-hidden="true">

						<div id="graph"></div>
							
						<figcaption class="graph-legend">

							<div class="data data-level">
								<span class="data-item font-xsmall data-level-item-heading" id="data-type">
									<i class="icon icon-point"></i>
									<span class="data-item-label">
										Latest measured level
									</span>
								</span>
								<span class="data-item bold-small" id="data-details">1.9m at 12:00pm on 16 May 2017</span>
							</div>
							
							<ul class="list-graph-labels">

								<li class="measured">
									<span>Measured level</span>
								</li>
								<li class="forecast">
									<span>Forecast level</span>
								</li>
								<li class="property">
									<span>4.2m</span>
								</li>
								<li class="land">
									<span>2.7m</span>
								</li>

							</ul>

							<div class="graph-legend-normal-level">

								<p class="font-xsmall">The normal level at this location is 0.75m to 2.70m.</p>

							</div>

						</figcaption>

					</figure>

				</div>

				<!-- End dynamic render -->

				<!--
					If Google Charts available add class visuallyhidden
				-->

				<div class="visualisation-table visuallyhidden">

					<div class="panel panel-border-narrow" aria-hidden="true">
						<p>
							A graph is available with JavaScript enabled and a modern browser
						</p>
					</div>

					<table class="table-levels" aria-labelledby="visualisation-heading">
						<thead>
							<tr>
								<th scope="col">Time</th> <!-- role="columnheader" ? -->
								<th scope="col" class="numeric">
									Level (<abbr title="Metres">m</abbr>)
								</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<th scope="col" colspan="2">
									<time datetime="2017-01-06T09:00+00:00">
										Friday 6 January	
									</time>
								</th>
							</tr>
							<tr>
								<td scope="row">
									<time datetime="2017-01-06T09:00+00:00">
										9:00am	
									</time>
								</td>
								<td class="numeric">
									0.43
									<span class="error">
										Error
									</span>
								</td>
							</tr>
						</tbody>
						<tbody>
							<tr>
								<td scope="row">
									<time datetime="2017-01-06T09:15+00:00">
										9:15am	
									</time>
								</td>
								<td class="numeric">
									0.48
								</td>
							</tr>	
						</tbody>
						<tbody>
							<tr>
								<th scope="col" colspan="2">
									<time datetime="2017-01-06T09:00+00:00">
										Saturday 7 January	
									</time>
								</th>
							</tr>
							<tr>
								<td scope="row">
									<time datetime="2017-01-06T09:00+00:00">
										9:00am
										<em class="forecast">
											(Latest recorded)
										</em>		
									</time>
								</td>
								<td class="numeric">
									0.59
									<span class="error">
										Error
									</span>
								</td>
							</tr>
						</tbody>
						<tbody>
							<tr>
								<td scope="row">
									<time datetime="2017-01-06T09:30+00:00">
										9:30am
										<em class="forecast">
											(Forecast)
										</em>	
									</time>
								</td>
								<td class="numeric">
									0.65
								</td>
							</tr>	
							<tr>
								<td scope="row">
									<time datetime="2017-01-06T09:45+00:00">
										9:45am
										<em class="forecast">
											(Highest forecast)
										</em>	
									</time>
								</td>
								<td class="numeric">
									0.63
								</td>
							</tr>
						</tbody>
					</table>

				</div>

				<!--
					End Google charts available
				-->

			</div>

		</section>

	</div>

</div>

<!-- Remove -->
<script>
	var visualisation = document.getElementsByClassName('visualisation')
	for (i=0; i<visualisation.length; i++){
		var table = visualisation[i].getElementsByClassName('visualisation-table')[0]
		var inner = visualisation[i].getElementsByClassName('visualisation-inner')[0]
		table.className += ' visuallyhidden'
		inner.className = 'visualisation-inner'
		inner.removeAttribute('hidden')
	}
</script>
<!-- End remove -->



  <div class="grid-row">

    <div class="column-two-thirds">

      <section class="target-areas">

        
<!--
<p>The latest level recorded is 0.90m at 9.00am on Wednesday 11 Jan 2017.</p>
<p>The highest level forecast in the next 36 hours is 0.91m at 9.00pm on Thursday 12 Jan 2017.</p>
-->
<h2 class="heading-medium" id="nearby-areas">What effect could these levels have on nearby areas?</h2>
<ul class="list">
	<li>
		<p>
			<strong class="bold-small">5.1m</strong> Highest level ever recorded here during Dec 2015 flooding.<br><a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">Show on the graph</a>. <a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">See map of area that flooded</a>
		</p>
	</li>
	<li>
		<p>
			<strong class="bold-small">5.0m</strong> Sep 2007 flood level.<br><a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">Show on the graph</a>. <a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">See map of area that flooded</a>
		</p>
	</li>
	<li>
		<p>
			<strong class="bold-small">4.8m</strong> Flooding of property possible at River Irk at Cheetham Hill.<br><a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">Show on the graph</a>. <a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">See map of area that could flood</a>
		</p>
	</li>
	<li>
		<p>
			<strong class="bold-small">4.2m</strong> Flooding of property possible at River Irk at Kendall Road.<br><a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">Hide from the graph</a>. <a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">See map of area that could flood</a>
		</p>
	</li>
	<li>
		<p>
			<strong class="bold-small">2.9m</strong> A26 crossroads floods.<br><a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">Show on the graph</a>
		</p>
	</li>
	<li>
		<p>
			<strong class="bold-small">2.7m</strong> Flooding of low lying land starts.<br><a href="http://localhost:3000/station/5034-confidence-rating#" onclick="return false">Hide from the graph</a>
		</p>
	</li>
</ul>


      </section>

    </div>

  </div>

  <div class="grid-row">

    <div class="column-two-thirds">

        <section class="nearby-measuring-stations">

          <h2 class="heading-medium" id="nearby-measuring-stations">View a nearby measuring station</h2>

          <p>Select a marker on the map to view measuring station.</p>

          <div id="map-levels" class="map-container">

            <img src="../assets/measuring-stations.png" alt="Screen grab">
<div class="ol-overlaycontainer-stopevent">
    <div class="ol-zoom ol-unselectable ol-control">
        <button class="ol-zoom-in" type="button" title="Zoom in">+</button>
        <button class="ol-zoom-out" type="button" title="Zoom out">−</button>
    </div>
    <div class="ol-rotate ol-unselectable ol-control ol-hidden">
        <button class="ol-rotate-reset" type="button" title="Reset rotation">
            <span class="ol-compass" style="transform: rotate(0rad);">⇧</span>
        </button>
    </div>
    <div class="ol-attribution ol-unselectable ol-control ol-collapsed">
        <ul>
            <li style="">
                <a href="https://openlayers.org/">
                    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC">
                </a>
            </li>
            <li>© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.</li>
        </ul>
        <button type="button" title="Attributions">
            <span>i</span>
        </button>
    </div>
</div>
            
          </div>

        </section>

        <details role="group">

          <summary role="button" aria-controls="details-content-0" aria-expanded="false"><span class="summary">How might river levels affect flood risk?</span></summary>

          <div class="panel panel-border-narrow" id="details-content-0" aria-hidden="true">

            <h3 class="heading-small">Within normal range</h3>
            <p>This is the usual range of river levels at this station, based on historical data.</p>

            <h3 class="heading-small">Above normal range</h3>
            <p>This means that flooding is possible because river levels at this station are currently higher than usual.</p>
            <p>Many factors can influence the possibility of flooding - river levels are only one indicator. Always check if there's a flood warning in place at a particular location.</p>

            <h3 class="heading-small">Below normal range</h3>
            <p>This means that river levels at this station are currently lower than usual.</p>
            <p>Drought or water management measures may be in place. Please check for the latest information on water resources and restrictions in your area.</p>

          </div>

        </details>

        <details role="group">

          <summary role="button" aria-controls="details-content-1" aria-expanded="false"><span class="summary">How are river levels measured?</span></summary>

          <div class="panel panel-border-narrow" id="details-content-1" aria-hidden="true">

            <p>The Environment agency uses a network of monitoring stations across the country. Each one has its own datum - a height in metres fixed relative to mean sea level. This height is expressed as metres above ordnance datum (mAOD). The river levels we provide for each monitoring station are all relative to its site datum.</p>

            <p>If we didn't do this, we'd show some very high measurements, which could cause confusion. By using a local site datum, the river levels are easier to understand, especially by users familiar with the data from a particular monitoring station.</p>

            <p>A river's height above ordnance datum can be seen by adding the site datum to the river level.</p>

            <p>The data we collect is fed into this service once or twice a day under typical conditions. We increase this frequency whenever there's a greater risk of flooding.</p>

          </div>

        </details>

        <details role="group">

          <summary role="button" aria-controls="details-content-2" aria-expanded="false"><span class="summary">How are forecast levels produced?</span></summary>

          <div class="panel panel-border-narrow" id="details-content-2" aria-hidden="true">

            <p>The forecast levels shown here are computer model predictions based on data and information including the Met Office’s rainfall forecasts and observed river levels. The coastal forecast levels are also based on predicted tide and wind information from the Met Office and other organisations.</p>

            <h3 class="heading-small">What's behind our forecasts?</h3>
            <p>The Environment Agency considers many things when producing its forecasts. These include the amount of rain that's fallen in the last few days and whether more is expected.</p><p>
            </p><p>It also looks at likely ground conditions, together with wind, tides and wave height.</p>
            <p>When the predicted conditions and river or sea levels combine to threaten flooding, forecasters issue flood alerts or, much more seriously, flood warnings.</p>

          </div>

        </details>

    </div>

  </div>

  <div class="grid-row">

    <div class="column-two-thirds">

    	<section class="social">
      
			<div class="icons-buttons">
				<h3 class="heading-medium">Share this page</h3>
				<ul>
					<li>
						<a target="_blank" href="https://twitter.com/intent/tweet?original_referer&amp;url=https%3A%2F%2Fgds.blog.gov.uk%2F2017%2F04%2F03%2Fwhat-we-blogged-about-in-march-2017%2F&amp;text=What+we+blogged+about+in+March+2017" class="twitter">Twitter</a>
					</li>
					<li>
						<a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fgds.blog.gov.uk%2F2017%2F04%2F03%2Fwhat-we-blogged-about-in-march-2017%2F" class="facebook">Facebook</a>
					</li>
					<li>
						<a href="mailto:?subject=I%20wanted%20to%20share%20this%20post%20with%20you%20from%20Government%20Digital%20Service&amp;body=What%20we%20blogged%20about%20in%20March%202017%20https://gds.blog.gov.uk/2017/04/03/what-we-blogged-about-in-march-2017/" class="email">Email</a>
					</li>
				</ul>
				<div class="clearfix"></div>
			</div>

		</section>

    </div>

  </div>

  <div class="grid-row">

    <div class="column-two-thirds">

      <nav class="secondary-nav">

        <ul class="secondary-links">

    <li>
        <a class="media" href="http://localhost:3000/" id="5090" onclick="return false;">
            <img class="img" src="../assets/ball-home.png" alt="National flood information service">
            <span class="content">National flood information service</span>
        </a>
    </li>

    <!--
    <li>
        <a class="media" href="/long-term-flood-risk" id="5090" onclick="return false;">
            <img class="img" src="/public/images/ball-risk.png" alt="View your property's long term risk of flooding" />
            <span class="content">View your property's long term risk of flooding</span>
        </a>
    </li>
    -->

    <li>
        <a class="media" href="http://localhost:3000/map" id="5090" onclick="return false;">
            <img class="img" src="../assets/ball-map.png" alt="View the current national flood situation">
            <span class="content">View the current national flood situation</span>
        </a>
    </li>

</ul>

      </nav>

    </div>

  </div>

  <div class="grid-row">

    <div class="column-two-thirds">

      <section class="feedback">
      
        <p class="font-xsmall">Your <a href="http://localhost:3000/station/5034-confidence-rating" onclick="return false;">feedback</a> will help us improve this service.</p>

      </section>

    </div>

  </div>

</main>




    <footer class="group js-footer" id="footer" role="contentinfo">

      <div class="footer-wrapper">
        

        <div class="footer-meta">
          <div class="footer-meta-inner">
            
<h2 class="visuallyhidden">Support links</h2>
<ul>
    <li><a href="http://localhost:3000/terms-conditions">Private beta terms of use</a></li>
    <li><a href="https://www.gov.uk/help">Help</a></li>
    <li><a href="https://www.gov.uk/help/cookies">Cookies</a></li>
    <li><a href="https://www.gov.uk/contact">Contact</a></li>
    <li><a href="https://www.gov.uk/cymraeg">Cymraeg</a></li>
    <li>Built by the <a href="https://www.gov.uk/government/organisations/environment-agency">Environment Agency</a>
    </li>
</ul>


            <div class="open-government-licence">
              <p class="logo"><a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence</a></p>
              
                <p>All content is available under the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence v3.0</a>, except where otherwise stated</p>
              
            </div>
          </div>

          <div class="copyright">
            <a href="http://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/copyright-and-re-use/crown-copyright/">© Crown copyright</a>
          </div>
        </div>
      </div>
    </footer>

    <div id="global-app-error" class="app-error hidden"></div>

    <script src="../assets/govuk-template.js"></script>

    
<!-- GOV.UK elements redirect -->
<script src="../assets/d3.v3.min.js"></script>
<script>

	var Chart = (function(window,d3) {

		const yExtension = 0.4,
			windowBreakPoint = 640,
			svgBreakPoint = 576,
			xCutOff = 9;

		var svg,
			data,
			x, y, 
			xAxis, yAxis, 
			dim, 
			chartWrapper, 
			line, area, path, 
			margin = {}, 
			locator, locatorX, locatorY,
			now, timeX,
			width, height,
			parentWidth, parentHeight,
			hasObserved = false, hasForecast = false, hasHighest = false, hasWarning = false, hasAlert = false,
			parseTime, parseDate,
			startPoint;


		d3.json('/public/javascripts/json/shrewsbury-probabilistic-c.json', init);

		function init(json) {

			data = json;

			// Setup array to combine observed and forecast points
			// and identify startPoint for locator 
			lines = [];
			if (data.observed) {
				lines = lines.concat(data.observed);
				startPoint = data.observed[data.observed.length-1];
				hasObserved = true;
			}
			if (data.forecast) {
				lines = lines.concat(data.forecast);
				startPoint = data.forecast[0];
				hasForecast = true;
			}

			//Initialize scales
			xExtent = d3.extent(lines, function(d,i) { return new Date(d.date) });
			yExtent = d3.extent(lines, function(d,i) { return d.level });

			// Set Y range to highest and lowest values from the data
			yRange = [yExtent[0],yExtent[1]];
			if (data.highest) { 
				yRange.push(data.highest); 
				hasHighest = true; 
			}
			if (data.warning) { 
				yRange.push(data.warning); 
				hasWarning = true; 
			}
			if (data.alert) { 
				yRange.push(data.alert); 
				hasAlert = true; 
			}
			yExtent[0] = Math.min.apply(Math,yRange);
			yExtent[1] = Math.max.apply(Math,yRange);

			// Add margin to bottom of Y Axis
			yExtent[0] = ((yExtent[0] * 100) - (yExtension * 100))/100;

			// Add margin to top of Y Axis
			yExtent[1] = ((yExtent[1] * 100) + (yExtension * 100))/100;

			// Setup scales
			x = d3.time.scale().domain(xExtent);
			y = d3.scale.linear().domain(yExtent);

			// Bisect date
			bisectDate = d3.bisector(function(d) { return new Date(d.date); }).left;

			//Initialize axis
			xAxis = d3.svg.axis().orient('bottom').outerTickSize(0);
			yAxis = d3.svg.axis().orient('left').ticks(5).tickFormat(function(d) { 
				return parseFloat(d).toFixed(1) + 'm'; 
			}).outerTickSize(0);

			//Area generator
			area = d3.svg.area()
			.interpolate('basis')
			.x(function(d) { return x(new Date(d.date)) })
			.y0(function(d) { return height })
			.y1(function(d) { return y(d.level) });

			//Line generator
			line = d3.svg.line()
			.interpolate('basis')
			.x(function(d) { return x(new Date(d.date)) })
			.y(function(d) { return y(d.level) });

			//Initialize svg
			svg = d3.select('#graph').append('svg').style('pointer-events', 'none');
			chartWrapper = svg.append('g').style('pointer-events', 'all');
			chartWrapper.append('g').classed('y grid', true);
			chartWrapper.append('g').classed('x grid', true);
			chartWrapper.append('g').classed('x axis', true);
			chartWrapper.append('g').classed('y axis', true);
			if (hasObserved) {
				chartWrapper.append('g').classed('observed observed-focus', true);
				//observedArea = svg.select('.observed').append('path').datum(data.observed).classed('observed-area', true);
				observed = svg.select('.observed').append('path').datum(data.observed).classed('observed-line', true);
			}
			if (hasForecast) {
				chartWrapper.append('g').classed('forecast', true);
				forecastArea = svg.select('.forecast').append('path').datum(data.forecastArea).classed('forecast-area', true);
				forecast = svg.select('.forecast').append('path').datum(data.forecast).classed('forecast-line', true);
			}
			chartWrapper.append('g').classed('thresholds', true);
			if (hasHighest) {
				svg.select('.thresholds').append('line').classed('highest', true);
			}
			if (hasWarning) {
				svg.select('.thresholds').append('line').classed('warning', true);
			}
			if (hasAlert) {
				svg.select('.thresholds').append('line').classed('alert', true);
			}
			chartWrapper.on('mousemove', mousemove);
			
			// Add timeline
			if(data.now) {
				chartWrapper.append('g').classed('time', true);
				now = svg.select('.time');
				svg.select('.time').append('line').classed('time-line', true);
				svg.select('.time').append('text').classed('time-now', true).text('Now');
			}

			// Add locator
			chartWrapper.append('g').classed('locator', true);
			locatorPoint = svg.select('.locator').append('circle').attr('r', 4).classed('locator-point', true);
			
			//Render the chart
			render();

		}

		function render() {

			//Get dimensions based on parent size
			parentWidth = Math.floor(d3.select('#graph').node().getBoundingClientRect().width);
			parentHeight = Math.floor(d3.select('#graph').node().getBoundingClientRect().height);
			updateDimensions(parentWidth, parentHeight);

			//Update x and y scales to new dimensions
			x.range([0, width]);
			y.range([height, 0]);

			//Update svg elements to new dimensions
			chartWrapper.attr('transform', 'translate(' + (margin.left + margin.right) + ',' + 0 + ')');

			//Update the axis and line
			xAxis.scale(x);
			yAxis.scale(y);
			svg.select('.x.axis')
			.attr('transform', 'translate(0,' + height + ')')
			.call(xAxis);
			svg.select('.y.axis')
			.call(yAxis);

			// Update grid lines
			svg.select('.x.grid')
			.attr('transform', 'translate(0,' + height + ')')
			.call(d3.svg.axis()
				.scale(x)
				.orient('bottom')
				.ticks(d3.time.day,1)
				.tickSize(-height, 0, 0)
				.tickFormat('')
			);
			svg.select('.y.grid')
			.attr('transform', 'translate(0,' + 0 + ')')
			.call(d3.svg.axis()
				.scale(y)
				.orient('left')
				.ticks(5)
				.tickSize(-width, 0, 0)
				.tickFormat('')
			);

			// Update thresholds
			if (hasHighest) {
				svg.select('.highest')
					.attr('transform', 'translate(0,' + y(data.highest) + ')')
					.attr('x2', x(xExtent[1]))
					.attr('y2', 0);
			}
			if (hasWarning) {
				svg.select('.warning')
					.attr('transform', 'translate(0,' + y(data.warning) + ')')
					.attr('x2', x(xExtent[1]))
					.attr('y2', 0);
			}
			if (hasAlert) {
				svg.select('.alert')
					.attr('transform', 'translate(0,' + y(data.alert) + ')')
					.attr('x2', x(xExtent[1]))
					.attr('y2', 0);
			}

			// Update locator
			locatorX = Math.floor(x(new Date(startPoint.date)));
			locatorY = Math.floor(y(startPoint.level));
			svg.select('.locator-point')			
				.attr('transform', 'translate(' + locatorX + ',' + locatorY + ')');

			// Update time line
			if(data.now) {
				timeX = Math.floor(x(new Date(data.now)));
				svg.select('.time-line').attr('y1', 0).attr('y2', height);
				svg.select('.time-now').attr('x', -17).attr('y', 25);
				now.attr('y1', 0).attr('y2', height)	
					.attr('transform', 'translate(' + timeX + ',0)');
				
				// Add 'today' class to x axis tick
				svg.selectAll('.x .tick')
					.filter(function(d){ 
						return new Date(d).getDay() == new Date(data.now).getDay() && new Date(d).getUTCHours() == 12
					})
					.attr('class', 'tick tick-today');
			}

			// Draw lines and areas
			if (hasObserved) {
				//observedArea.attr('d', area);
				observed.attr('d', line);
			}
			if (hasForecast) {
				forecastArea.attr('d', area);
				forecast.attr('d', line);
			}

			// Update legend
			parseTime = d3.time.format.utc('%-I:%M%p');
			parseDate = d3.time.format.utc('%e %b %Y');
			d3.select('#data-details').html(
				+ startPoint.level + 'm at '
				+ parseTime(new Date(startPoint.date)).toLowerCase()
				+ ' on '
				+ parseDate(new Date(startPoint.date))
			);

		}

		function updateDimensions(parentWidth, parentHeight) {

			margin.top = 25;
			margin.bottom = 25;
			margin.left = 18;
			margin.right = 18;

			xCutOffLeft = d3.time.hour.offset(xExtent[0], + xCutOff).getTime();
			xCutOffRight = d3.time.hour.offset(xExtent[1], - xCutOff).getTime();

			// Mobile first

			xAxis.ticks(d3.time.hour.utc, 12).tickFormat(function(d) {
				if (d.getUTCHours() == 12 & d >= xCutOffLeft & d <= xCutOffRight) {
					formatter = d3.time.format('%e %b');
					return formatter(d);
				} else {
					return null
				}
			});

			// Greater than window or svg breakpoint

			if(window.innerWidth > windowBreakPoint && parentWidth > svgBreakPoint) {
				xAxis.ticks(d3.time.hour.utc, 12).tickFormat(function(d) {
					if (d.getUTCHours() == 12 & d.getTime() >= xCutOffLeft & d.getTime() <= xCutOffRight) {
						formatter = d3.time.format('%a, %e %b');
						return formatter(d);
					} else {
						return null
					}
				});
				margin.left = 21;
				margin.right = 21;
			}

			width = parentWidth - margin.left - margin.right;
			height = parentHeight - margin.top - margin.bottom;

		}

		function mousemove() {

			var x0 = x.invert(d3.mouse(this)[0]),
			i = bisectDate(lines, x0, 1);
			d0 = lines[i - 1];
			d1 = lines[i];

			d = x0 - new Date(d0.date) > new Date(d1.date) - x0 ? d1 : d0;

			locatorX = Math.floor(x(new Date(d.date)));
			locatorY = Math.floor(y(d.level));
			latestX = Math.floor(x(new Date(startPoint.date)));

			// Update figcaption data

			if (locatorX > latestX) {
				locatorPoint.classed('locator-point-forecast', true);
				svg.select('.forecast').classed('forecast-focus', true);
				svg.select('.observed').classed('observed-focus', false);
				d3.select('#data-type').classed('data-level-item-heading-forecast', true).select('span').html('Forecast level');
			} else {
				locatorPoint.classed('locator-point-forecast', false);
				svg.select('.forecast').classed('forecast-focus', false);
				svg.select('.observed').classed('observed-focus', true);
				d3.select('#data-type').classed('data-level-item-heading-forecast', false).select('span').html('Previously measured level');
			}

			if (locatorX == latestX) {
				d3.select('#data-type').classed('data-level-item-heading-forecast', false).select('span').html('Latest measured level');
			}

			d3.select('#data-details').html(
				+ d.level + 'm at '
				+ parseTime(new Date(d.date)).toLowerCase()
				+ ' on '
				+ parseDate(new Date(d.date)));

			locatorPoint.attr('transform', 'translate(' + locatorX + ',' + locatorY + ')');

		}

		return {

			render : render

		}

	})(window,d3);

	window.addEventListener('resize', Chart.render);

</script>
<script src="../assets/jquery-1.11.0.min.js"></script>

<!-- govuk_frontend_toolkit js -->
<script src="../assets/bind.js"></script>
<script src="../assets/selection-buttons.js"></script>
<script src="../assets/shim-links-with-button-role.js"></script>
<script src="../assets/show-hide-content.js"></script>

<!-- govuk_elements js -->
<script src="../assets/prism.js"></script>
<script src="../assets/details.polyfill.js"></script>
<script src="../assets/application.js"></script>



    
    <script>if (typeof window.GOVUK === 'undefined') document.body.className = document.body.className.replace('js-enabled', '');</script>
  

</body></html>